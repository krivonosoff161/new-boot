#!/usr/bin/env python3
"""
–ü—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
"""

import os
import sys
from waitress import serve
from src.web.app import create_app

def main():
    """–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä–∞"""
    
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    app = create_app()
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–∞–∫—à–Ω–∞
    host = '0.0.0.0'  # –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤—Å–µ—Ö IP
    port = int(os.environ.get('PORT', 5000))
    
    print("üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä–∞...")
    print(f"üì° –ê–¥—Ä–µ—Å: http://{host}:{port}")
    print(f"üë• –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ‚úÖ")
    print(f"üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚úÖ")
    print(f"‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ‚úÖ")
    print("=" * 50)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º Waitress —Å–µ—Ä–≤–µ—Ä
    serve(
        app,
        host=host,
        port=port,
        threads=8,  # 8 –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
        connection_limit=100,  # –õ–∏–º–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
        cleanup_interval=30,  # –û—á–∏—Å—Ç–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
        channel_timeout=120,  # –¢–∞–π–º–∞—É—Ç –∫–∞–Ω–∞–ª–∞ 2 –º–∏–Ω
        log_socket_errors=True,
        max_request_header_size=262144,  # 256KB
        max_request_body_size=1073741824,  # 1GB
    )

if __name__ == '__main__':
    main()








